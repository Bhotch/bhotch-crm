{"ast":null,"code":"import _objectSpread from\"C:/Users/PC_User/Desktop/free-crm/bhotch-crm/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";// Fix for deployment environment variable parsing issue\nlet GOOGLE_SCRIPT_URL=process.env.REACT_APP_GAS_WEB_APP_URL;// Handle case where environment variable includes the variable name\nif(GOOGLE_SCRIPT_URL&&GOOGLE_SCRIPT_URL.includes('REACT_APP_GAS_WEB_APP_URL=')){GOOGLE_SCRIPT_URL=GOOGLE_SCRIPT_URL.split('REACT_APP_GAS_WEB_APP_URL=')[1];}// Ensure URL has proper protocol\nif(GOOGLE_SCRIPT_URL&&!GOOGLE_SCRIPT_URL.startsWith('http')){GOOGLE_SCRIPT_URL='https://'+GOOGLE_SCRIPT_URL.replace(/^\\/+/,'');}class GoogleSheetsService{constructor(baseURL){this.baseURL=baseURL;}async makeRequest(action,payload){if(!this.baseURL)return{success:false,message:'API endpoint is not configured.'};// Debug logging for URL issues\nconsole.log('Making request to:',this.baseURL);console.log('Raw environment variable:',process.env.REACT_APP_GAS_WEB_APP_URL);console.log('Cleaned URL:',GOOGLE_SCRIPT_URL);try{const response=await fetch(this.baseURL,{method:'POST',mode:'cors',credentials:'omit',headers:{'Content-Type':'text/plain;charset=utf-8'},body:JSON.stringify(_objectSpread({action},payload))});if(!response.ok)throw new Error(\"Server responded with status: \".concat(response.status));const text=await response.text();try{const result=JSON.parse(text);if(result.success===false)throw new Error(result.message||'An unknown backend error occurred.');return result;}catch(_unused){throw new Error('Invalid server response. The backend may have crashed.');}}catch(error){return{success:false,message:\"Network error: \".concat(error.message)};}}fetchLeads(){return this.makeRequest('getLeads',{});}addLead(lead){return this.makeRequest('addLead',{lead});}updateLead(lead){return this.makeRequest('updateLead',{lead});}deleteLead(leadId){return this.makeRequest('deleteLead',{leadId});}testConnection(){return this.makeRequest('testConnection',{});}geocodeAddress(address){return this.makeRequest('geocodeAddress',{address});}}export const googleSheetsService=new GoogleSheetsService(GOOGLE_SCRIPT_URL);","map":{"version":3,"names":["GOOGLE_SCRIPT_URL","process","env","REACT_APP_GAS_WEB_APP_URL","includes","split","startsWith","replace","GoogleSheetsService","constructor","baseURL","makeRequest","action","payload","success","message","console","log","response","fetch","method","mode","credentials","headers","body","JSON","stringify","_objectSpread","ok","Error","concat","status","text","result","parse","_unused","error","fetchLeads","addLead","lead","updateLead","deleteLead","leadId","testConnection","geocodeAddress","address","googleSheetsService"],"sources":["C:/Users/PC_User/Desktop/free-crm/bhotch-crm/src/api/googleSheetsService.js"],"sourcesContent":["// Fix for deployment environment variable parsing issue\r\nlet GOOGLE_SCRIPT_URL = process.env.REACT_APP_GAS_WEB_APP_URL;\r\n\r\n// Handle case where environment variable includes the variable name\r\nif (GOOGLE_SCRIPT_URL && GOOGLE_SCRIPT_URL.includes('REACT_APP_GAS_WEB_APP_URL=')) {\r\n  GOOGLE_SCRIPT_URL = GOOGLE_SCRIPT_URL.split('REACT_APP_GAS_WEB_APP_URL=')[1];\r\n}\r\n\r\n// Ensure URL has proper protocol\r\nif (GOOGLE_SCRIPT_URL && !GOOGLE_SCRIPT_URL.startsWith('http')) {\r\n  GOOGLE_SCRIPT_URL = 'https://' + GOOGLE_SCRIPT_URL.replace(/^\\/+/, '');\r\n}\r\n\r\nclass GoogleSheetsService {\r\n  constructor(baseURL) { this.baseURL = baseURL; }\r\n    \r\n  async makeRequest(action, payload) {\r\n    if (!this.baseURL) return { success: false, message: 'API endpoint is not configured.' };\r\n\r\n    // Debug logging for URL issues\r\n    console.log('Making request to:', this.baseURL);\r\n    console.log('Raw environment variable:', process.env.REACT_APP_GAS_WEB_APP_URL);\r\n    console.log('Cleaned URL:', GOOGLE_SCRIPT_URL);\r\n\r\n    try {\r\n      const response = await fetch(this.baseURL, {\r\n        method: 'POST', mode: 'cors', credentials: 'omit',\r\n        headers: { 'Content-Type': 'text/plain;charset=utf-8' },\r\n        body: JSON.stringify({ action, ...payload })\r\n      });\r\n      if (!response.ok) throw new Error(`Server responded with status: ${response.status}`);\r\n      const text = await response.text();\r\n      try { \r\n        const result = JSON.parse(text);\r\n        if (result.success === false) throw new Error(result.message || 'An unknown backend error occurred.');\r\n        return result;\r\n      }\r\n      catch { throw new Error('Invalid server response. The backend may have crashed.'); }\r\n    } catch (error) {\r\n      return { success: false, message: `Network error: ${error.message}` };\r\n    }\r\n  }\r\n    \r\n  fetchLeads() { return this.makeRequest('getLeads', {}); }\r\n  addLead(lead) { return this.makeRequest('addLead', { lead }); }\r\n  updateLead(lead) { return this.makeRequest('updateLead', { lead }); }\r\n  deleteLead(leadId) { return this.makeRequest('deleteLead', { leadId }); }\r\n  testConnection() { return this.makeRequest('testConnection', {}); }\r\n  geocodeAddress(address) { return this.makeRequest('geocodeAddress', { address }); }\r\n}\r\n\r\nexport const googleSheetsService = new GoogleSheetsService(GOOGLE_SCRIPT_URL);"],"mappings":"iIAAA;AACA,GAAI,CAAAA,iBAAiB,CAAGC,OAAO,CAACC,GAAG,CAACC,yBAAyB,CAE7D;AACA,GAAIH,iBAAiB,EAAIA,iBAAiB,CAACI,QAAQ,CAAC,4BAA4B,CAAC,CAAE,CACjFJ,iBAAiB,CAAGA,iBAAiB,CAACK,KAAK,CAAC,4BAA4B,CAAC,CAAC,CAAC,CAAC,CAC9E,CAEA;AACA,GAAIL,iBAAiB,EAAI,CAACA,iBAAiB,CAACM,UAAU,CAAC,MAAM,CAAC,CAAE,CAC9DN,iBAAiB,CAAG,UAAU,CAAGA,iBAAiB,CAACO,OAAO,CAAC,MAAM,CAAE,EAAE,CAAC,CACxE,CAEA,KAAM,CAAAC,mBAAoB,CACxBC,WAAWA,CAACC,OAAO,CAAE,CAAE,IAAI,CAACA,OAAO,CAAGA,OAAO,CAAE,CAE/C,KAAM,CAAAC,WAAWA,CAACC,MAAM,CAAEC,OAAO,CAAE,CACjC,GAAI,CAAC,IAAI,CAACH,OAAO,CAAE,MAAO,CAAEI,OAAO,CAAE,KAAK,CAAEC,OAAO,CAAE,iCAAkC,CAAC,CAExF;AACAC,OAAO,CAACC,GAAG,CAAC,oBAAoB,CAAE,IAAI,CAACP,OAAO,CAAC,CAC/CM,OAAO,CAACC,GAAG,CAAC,2BAA2B,CAAEhB,OAAO,CAACC,GAAG,CAACC,yBAAyB,CAAC,CAC/Ea,OAAO,CAACC,GAAG,CAAC,cAAc,CAAEjB,iBAAiB,CAAC,CAE9C,GAAI,CACF,KAAM,CAAAkB,QAAQ,CAAG,KAAM,CAAAC,KAAK,CAAC,IAAI,CAACT,OAAO,CAAE,CACzCU,MAAM,CAAE,MAAM,CAAEC,IAAI,CAAE,MAAM,CAAEC,WAAW,CAAE,MAAM,CACjDC,OAAO,CAAE,CAAE,cAAc,CAAE,0BAA2B,CAAC,CACvDC,IAAI,CAAEC,IAAI,CAACC,SAAS,CAAAC,aAAA,EAAGf,MAAM,EAAKC,OAAO,CAAE,CAC7C,CAAC,CAAC,CACF,GAAI,CAACK,QAAQ,CAACU,EAAE,CAAE,KAAM,IAAI,CAAAC,KAAK,kCAAAC,MAAA,CAAkCZ,QAAQ,CAACa,MAAM,CAAE,CAAC,CACrF,KAAM,CAAAC,IAAI,CAAG,KAAM,CAAAd,QAAQ,CAACc,IAAI,CAAC,CAAC,CAClC,GAAI,CACF,KAAM,CAAAC,MAAM,CAAGR,IAAI,CAACS,KAAK,CAACF,IAAI,CAAC,CAC/B,GAAIC,MAAM,CAACnB,OAAO,GAAK,KAAK,CAAE,KAAM,IAAI,CAAAe,KAAK,CAACI,MAAM,CAAClB,OAAO,EAAI,oCAAoC,CAAC,CACrG,MAAO,CAAAkB,MAAM,CACf,CACA,MAAAE,OAAA,CAAM,CAAE,KAAM,IAAI,CAAAN,KAAK,CAAC,wDAAwD,CAAC,CAAE,CACrF,CAAE,MAAOO,KAAK,CAAE,CACd,MAAO,CAAEtB,OAAO,CAAE,KAAK,CAAEC,OAAO,mBAAAe,MAAA,CAAoBM,KAAK,CAACrB,OAAO,CAAG,CAAC,CACvE,CACF,CAEAsB,UAAUA,CAAA,CAAG,CAAE,MAAO,KAAI,CAAC1B,WAAW,CAAC,UAAU,CAAE,CAAC,CAAC,CAAC,CAAE,CACxD2B,OAAOA,CAACC,IAAI,CAAE,CAAE,MAAO,KAAI,CAAC5B,WAAW,CAAC,SAAS,CAAE,CAAE4B,IAAK,CAAC,CAAC,CAAE,CAC9DC,UAAUA,CAACD,IAAI,CAAE,CAAE,MAAO,KAAI,CAAC5B,WAAW,CAAC,YAAY,CAAE,CAAE4B,IAAK,CAAC,CAAC,CAAE,CACpEE,UAAUA,CAACC,MAAM,CAAE,CAAE,MAAO,KAAI,CAAC/B,WAAW,CAAC,YAAY,CAAE,CAAE+B,MAAO,CAAC,CAAC,CAAE,CACxEC,cAAcA,CAAA,CAAG,CAAE,MAAO,KAAI,CAAChC,WAAW,CAAC,gBAAgB,CAAE,CAAC,CAAC,CAAC,CAAE,CAClEiC,cAAcA,CAACC,OAAO,CAAE,CAAE,MAAO,KAAI,CAAClC,WAAW,CAAC,gBAAgB,CAAE,CAAEkC,OAAQ,CAAC,CAAC,CAAE,CACpF,CAEA,MAAO,MAAM,CAAAC,mBAAmB,CAAG,GAAI,CAAAtC,mBAAmB,CAACR,iBAAiB,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}